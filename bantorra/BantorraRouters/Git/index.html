<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Git (bantorra.BantorraRouters.Git)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.2"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> – <a href="../../index.html">bantorra</a> &#x00BB; <a href="../index.html">BantorraRouters</a> &#x00BB; Git</nav><h1>Module <code>BantorraRouters.Git</code></h1><nav class="toc"><ul><li><a href="#the-builder">The Builder</a></li></ul></nav></header><aside><p>The git resolver takes a URL that the <code>git</code> tool can understand, clones the repository and returns the library root within the local copy.</p><p>The resolver takes a JSON argument in one of the following formats:</p><pre>{
    &quot;url&quot;: &quot;git@github.com:favonia/bantorra.git&quot;,
    &quot;ref&quot;: &quot;main&quot;,
    &quot;path&quot;: &quot;src/library&quot;
}</pre><pre>{
    &quot;url&quot;: &quot;git@github.com:favonia/bantorra.git&quot;,
    &quot;ref&quot;: &quot;main&quot;
}</pre><pre>{
    &quot;url&quot;: &quot;git@github.com:favonia/bantorra.git&quot;,
    &quot;path&quot;: &quot;src/library&quot;
}</pre><pre>{
    &quot;url&quot;: &quot;git@github.com:favonia/bantorra.git&quot;
}</pre><p>The <code>ref</code> field can be a commit ID, a branch name, a tag name, or anything accepted by <code>git fetch</code>. The only restriction is that <code>ref</code> should not contain a non-empty branch destination <code>&lt;dst&gt;</code> in the git ref specification as in the documentation of <code>git fetch</code>. (The older <code>git</code> before year 2015 would not accept commit IDs, but please upgrade it already.) The <code>path</code> field is the relative path pointing to the root of the library. If the <code>path</code> field is missing, then the tool assumes the library is at the root of the repository. If the <code>ref</code> field is missing, then <code>&quot;HEAD&quot;</code> is used, which should point to the tip of the default branch in the remote repository.</p><p>Different URLs pointing to the &quot;same&quot; git repository are treated as different libraries. Therefore, <code>git@github.com:RedPRL/bantorra.git</code> and <code>https://github.com/RedPRL/bantorra.git</code> are treated as two different git repositories. The resolver cannot identify a remote git repository with any local copy not managed by the resolver, either. A proper solution to this problem is a different resolver mapping global package names to repositories, such as the OPAM package index for the OCaml language.</p><p>Given the same URL, the commit IDs in use must be identical during the program execution. One can use different branch names or tag names, but they all need to point to the same commit ID. The resolution would fail if there is an attempt to use different commits of the same repository. Otherwise, the semantics of importing would be broken. As a result, it is a good idea to use stable tags in larger developments, unless the latest commit is absolutely needed. One common case would be two libraries in the same repository depending on each other, but then one should local, relative references such as <em>waypoints</em> implemented by <span class="xref-unresolved" title="unresolved reference to &quot;BantorraResolvers.Waypoint&quot;"><code>BantorraResolvers</code>.Waypoint</span>.</p></aside><section><header><h2 id="the-builder"><a href="#the-builder" class="anchor"></a>The Builder</h2></header><dl><dt class="spec value" id="val-router"><a href="#val-router" class="anchor"></a><code><span class="keyword">val</span> router : <span>?&#8288;eager_resolution:bool</span> <span>&#45;&gt;</span> <span>crate_root:<a href="../../BantorraBasis/File/index.html#type-filepath">BantorraBasis.File.filepath</a></span> <span>&#45;&gt;</span> <span><span>(<a href="../../Bantorra/Router/index.html#type-t">Bantorra.Router.t</a>, <span>[&gt; <span>`InvalidRouter of string</span> ]</span>)</span> Stdlib.result</span></code></dt><dd><p><code>router ~crate_root</code> downloads git repositories, when requested, into the directory <code>crate_root</code> and resolves the URL into a path pointing to a local copy of the library. The resolver assumes the directory <code>crate_root</code> already exists and it has total control over the directory during the program execution.</p><dl><dt>parameter eager_resolution</dt><dd><p>Whether full resolution is performed to check the validity of arguments. If the value is <code>true</code>, the resolver will immediately download the library when it receives a URL. If the value is <code>false</code>, the resolver will only check whether the argument is well-formed JSON. The default value is <code>false</code>.</p></dd></dl></dd></dl></section></div></body></html>